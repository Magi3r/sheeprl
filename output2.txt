/home/dude/Desktop/sheeprl/.venv/lib/python3.10/site-packages/lightning_utilities/core/imports.py:13: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Seed set to 5
A.L.E: Arcade Learning Environment (version 0.8.1+53f58b7)
[Powered by Stella]
/home/dude/Desktop/sheeprl/.venv/lib/python3.10/site-packages/gymnasium/experimental/wrappers/rendering.py:166: UserWarning: [33mWARN: Overwriting existing videos at /home/dude/Desktop/sheeprl/logs/runs/dem/PongNoFrameskip-v4/2026-01-12_17-59-34_dem_PongNoFrameskip-v4_5/version_0/train_videos folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
/home/dude/Desktop/sheeprl/sheeprl/algos/dem/episodic_memory_gpu.py:88: UserWarning: EpisodicMemory currently only works with a single environment instance!
  warnings.warn("EpisodicMemory currently only works with a single environment instance!")
/home/dude/Desktop/sheeprl/.venv/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: The ``compute`` method of metric MeanMetric was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)
Error executing job with overrides: ['exp=dem_100k_pong', 'algo=dem', 'fabric.accelerator=gpu']
Traceback (most recent call last):
  File "/home/dude/Desktop/sheeprl/sheeprl/cli.py", line 366, in run
    run_algorithm(cfg)
  File "/home/dude/Desktop/sheeprl/sheeprl/cli.py", line 199, in run_algorithm
    fabric.launch(reproducible(command), cfg, **kwargs)
  File "/home/dude/Desktop/sheeprl/.venv/lib/python3.10/site-packages/lightning/fabric/fabric.py", line 845, in launch
    return self._wrap_and_launch(function, self, *args, **kwargs)
  File "/home/dude/Desktop/sheeprl/.venv/lib/python3.10/site-packages/lightning/fabric/fabric.py", line 931, in _wrap_and_launch
    return to_run(*args, **kwargs)
  File "/home/dude/Desktop/sheeprl/.venv/lib/python3.10/site-packages/lightning/fabric/fabric.py", line 936, in _wrap_with_setup
    return to_run(*args, **kwargs)
  File "/home/dude/Desktop/sheeprl/sheeprl/cli.py", line 195, in wrapper
    return func(fabric, cfg, *args, **kwargs)
  File "/home/dude/Desktop/sheeprl/sheeprl/algos/dem/dem.py", line 1025, in main
    train(
  File "/home/dude/Desktop/sheeprl/sheeprl/algos/dem/dem.py", line 333, in train
    ACDs: np.array = parallel_additive_correction_delta(recurrent_state,
  File "/home/dude/Desktop/sheeprl/sheeprl/algos/dem/utils.py", line 314, in parallel_additive_correction_delta
    nn_trajectories = torch.from_numpy(np.array(nn_trajectories)).to(device)
  File "/home/dude/Desktop/sheeprl/.venv/lib/python3.10/site-packages/torch/_tensor.py", line 1211, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
